<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Home</title>
    <style>
        :root {
            /* === å€åŸŸå¾®èª¿è¨­å®š (è«‹ä¾ç…§é–‹ç™¼æ¨¡å¼èª¿æ•´) === */
            --status-bar-height: 50px;
            --gap-height: 40px; 
            --dock-height: 13vh;
            --mask-color: #000000; 
        }

        body {
            margin: 0; padding: 0; background-color: #000; overflow: hidden;
            -webkit-touch-callout: none; -webkit-user-select: none; user-select: none;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* é®ç½©å±¤è¨­å®š */
        #status-bar-mask {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--status-bar-height);
            background-color: var(--mask-color); z-index: 100; pointer-events: none;
        }
        #gap-mask {
            position: fixed; bottom: var(--dock-height); left: 0; width: 100%; height: var(--gap-height);
            background-color: var(--mask-color); z-index: 55; pointer-events: none;
        }

        /* Dock å±¤ */
        #fixed-dock-container {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--dock-height);
            z-index: 50; overflow: hidden; pointer-events: none;
        }
        #fixed-dock-image {
            width: 100%; height: 100vh; position: absolute; bottom: 0; left: 0;
            background-image: url('page1.png'); background-size: cover;
            background-position: center bottom; background-repeat: no-repeat;
        }

        /* æ»‘å‹•å®¹å™¨ */
        #slider {
            display: flex; width: 100vw; height: 100vh; overflow-x: auto; overflow-y: hidden;
            scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scrollbar-width: none;
            position: relative; z-index: 1; 
        }
        #slider::-webkit-scrollbar { display: none; }
        .slide {
            position: relative; flex: 0 0 100vw; height: 100vh; scroll-snap-align: start;
            background-size: cover; background-position: center top; background-repeat: no-repeat; overflow: hidden;
        }
        #page-1 { background-image: url('page1.png'); }
        #page-2 { background-image: url('page2.png'); }
        #page-3 { background-image: url('page3.png'); }

        /* === æš—è¼¸å…¥ç³»çµ± UI === */
        #number-grid {
            position: absolute;
            top: var(--status-bar-height);
            left: 5%; width: 90%; height: 60%;
            z-index: 80;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 5px;
        }

        .num-btn { border-radius: 15px; cursor: pointer; -webkit-tap-highlight-color: transparent; }
        .num-btn:active { background-color: rgba(0,0,0,0.3); }

        #suit-grid {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--dock-height);
            z-index: 90; display: flex;
        }

        .suit-btn { flex: 1; cursor: pointer; -webkit-tap-highlight-color: transparent; }
        .suit-btn:active { background-color: rgba(0,0,0,0.3); }

        /* === åˆ†é åœ“é» === */
        #pagination {
            position: fixed; bottom: calc(var(--dock-height) + (var(--gap-height) / 2) - 4px);
            left: 0; width: 100%; display: flex; justify-content: center; gap: 8px;
            pointer-events: none; z-index: 70; transition: opacity 0.2s;
        }
        .dot {
            width: 8px; height: 8px; background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%; transition: background-color 0.2s; backdrop-filter: blur(2px);
        }
        .dot.active { background-color: #fff; }

        /* === é–‹ç™¼è€…æ¨¡å¼ === */
        .dev-mode #number-grid .num-btn {
            border: 1px solid cyan; color: cyan; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 20px; background: rgba(0, 255, 255, 0.1);
        }
        .dev-mode #suit-grid .suit-btn {
            border: 1px solid magenta; color: magenta; display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 30px; background: rgba(255, 0, 255, 0.1);
        }
        .dev-mode #gap-mask { background-color: rgba(255, 255, 0, 0.3) !important; border: 1px dashed yellow; }
        .dev-mode #status-bar-mask { background-color: rgba(0, 255, 0, 0.3) !important; }
        .dev-mode #fixed-dock-container { border-top: 2px solid red; }

        #dev-info { display: none; position: fixed; top: 100px; left: 0; width: 100%; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; text-align: center; font-family: monospace; font-size: 14px; z-index: 200; pointer-events: none; }
        #secret-switch { position: fixed; bottom: 0; right: 0; width: 60px; height: 60px; z-index: 99; }
    </style>
</head>
<body>

    <div id="status-bar-mask"></div>
    <div id="gap-mask"></div>
    <div id="fixed-dock-container">
        <div id="fixed-dock-image"></div>
    </div>

    <div id="suit-grid">
        <div class="suit-btn" onclick="selectSuit('S')"></div>
        <div class="suit-btn" onclick="selectSuit('H')"></div>
        <div class="suit-btn" onclick="selectSuit('C')"></div>
        <div class="suit-btn" onclick="selectSuit('D')"></div>
    </div>

    <div id="slider">
        <div id="page-1" class="slide">
            <div id="number-grid">
                <div class="num-btn" onclick="selectNum(1)"></div>
                <div class="num-btn" onclick="selectNum(2)"></div>
                <div class="num-btn" onclick="selectNum(3)"></div>
                <div class="num-btn" onclick="selectNum(4)"></div>
                <div class="num-btn" onclick="selectNum(5)"></div>
                <div class="num-btn" onclick="selectNum(6)"></div>
                <div class="num-btn" onclick="selectNum(7)"></div>
                <div class="num-btn" onclick="selectNum(8)"></div>
                <div class="num-btn" onclick="selectNum(9)"></div>
                <div class="num-btn" onclick="selectNum(10)"></div>
                <div class="num-btn" onclick="selectNum(11)"></div>
                <div class="num-btn" onclick="selectNum(12)"></div>
                <div class="num-btn" onclick="selectNum(13)"></div>
                <div class="num-btn"></div><div class="num-btn"></div><div class="num-btn"></div>
            </div>
            <img src="page1.png" style="display:none;" onerror="alert('âš ï¸ è®€å–ä¸åˆ° page1.png')">
        </div>
        <div id="page-2" class="slide"></div>
        <div id="page-3" class="slide"></div>
    </div>

    <div id="pagination">
        <div class="dot active"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    </div>

    <div id="secret-switch" onclick="toggleDevMode()"></div>
    <div id="dev-info"></div>

    <script>
        let currentNumber = null;
        const slider = document.getElementById('slider');
        const dockContainer = document.getElementById('fixed-dock-container');
        const gapMask = document.getElementById('gap-mask');
        const suitGrid = document.getElementById('suit-grid');
        const dots = document.querySelectorAll('.dot');
        const dotsContainer = document.getElementById('pagination');
        let viewportWidth = window.innerWidth;

        slider.addEventListener('scroll', () => {
            const x = slider.scrollLeft;
            const pageIndex = Math.round(x / viewportWidth);
            dots.forEach((dot, index) => dot.classList.toggle('active', index === pageIndex));

            const page2Start = viewportWidth; 
            if (x > page2Start) {
                const offset = x - page2Start;
                dockContainer.style.transform = `translateX(${-offset}px)`;
                gapMask.style.transform = `translateX(${-offset}px)`;
                suitGrid.style.transform = `translateX(${-offset}px)`;
                dotsContainer.style.opacity = offset > viewportWidth * 0.5 ? '0' : '1';
            } else {
                dockContainer.style.transform = `translateX(0px)`;
                gapMask.style.transform = `translateX(0px)`;
                suitGrid.style.transform = `translateX(0px)`;
                dotsContainer.style.opacity = '1';
            }
        });

        window.addEventListener('resize', () => { viewportWidth = window.innerWidth; });

        function selectNum(num) {
            currentNumber = num;
            if (navigator.vibrate) navigator.vibrate(20);
            if(isDevMode) showToast(`å·²é¸æ“‡æ•¸å­—: ${num} (è«‹é¸èŠ±è‰²)`);
        }

        function selectSuit(suit) {
            if (currentNumber === null) {
                if(isDevMode) { showToast("âš ï¸ è«‹å…ˆé»æ“Šä¸Šæ–¹ App é¸æ“‡æ•¸å­—ï¼"); return; }
            }
            const safeNum = currentNumber || 1;
            const suitMap = { 'S': 1, 'H': 2, 'C': 3, 'D': 4 };
            const suitDigit = suitMap[suit];
            const numDigit = String(safeNum).padStart(2, '0');
            const finalCode = `${suitDigit}${numDigit}`;
            
            copyToClipboard(finalCode);
            
            // éœ‡å‹•å›é¥‹
            if (navigator.vibrate) navigator.vibrate([30, 50, 30]);

            if(isDevMode) showToast(`ğŸ“‹ å·²è¤‡è£½: ${finalCode}`);
            
            // é‡ç½®æ•¸å­—ï¼Œä½† **ä¸** æ¸…ç©ºç•«é¢
            currentNumber = null;
        }

        function copyToClipboard(text) {
            const el = document.createElement('textarea');
            el.value = text;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            try { document.execCommand('copy'); } catch (e) {}
            document.body.removeChild(el);
        }

        let isDevMode = false;
        function toggleDevMode() {
            isDevMode = !isDevMode;
            document.body.classList.toggle('dev-mode');
            const numBtns = document.querySelectorAll('.num-btn');
            numBtns.forEach((btn, idx) => { if (idx < 13) btn.innerText = idx + 1; });
            const suitBtns = document.querySelectorAll('.suit-btn');
            const suits = ['â™ ï¸', 'â™¥ï¸', 'â™£ï¸', 'â™¦ï¸'];
            suitBtns.forEach((btn, idx) => btn.innerText = suits[idx]);

            const info = document.getElementById('dev-info');
            if (isDevMode) {
                info.style.display = 'block';
                alert("ğŸ”´ é–‹ç™¼æ¨¡å¼\n\nä¸Šæ–¹è—æ¡†ï¼šæ•¸å­— 1-13\nä¸‹æ–¹ç²‰ç´…æ¡†ï¼šèŠ±è‰²\n\né †åºï¼šå…ˆé»æ•¸å­— -> å†é»èŠ±è‰²");
            } else {
                info.style.display = 'none';
                numBtns.forEach(b => b.innerText = '');
                suitBtns.forEach(b => b.innerText = '');
            }
        }
        
        function showToast(msg) {
            const info = document.getElementById('dev-info');
            info.innerText = msg;
            info.style.display = 'block';
            setTimeout(() => { if(isDevMode) info.innerText = "é–‹ç™¼æ¨¡å¼å¾…æ©Ÿä¸­..."; }, 2000);
        }

        document.body.addEventListener('touchmove', function(e) {}, { passive: false });
    </script>
</body>
</html>
