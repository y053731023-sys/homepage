<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Home</title>
    <style>
        :root {
            /* === å€åŸŸå¾®èª¿è¨­å®š (è«‹ä¾ç…§é–‹ç™¼æ¨¡å¼èª¿æ•´) === */
            --status-bar-height: 50px;
            --gap-height: 25px; 
            --dock-height: 11.8vh;
            --mask-color: #000000; 
        }

        body {
            margin: 0; padding: 0; background-color: #000; overflow: hidden;
            -webkit-touch-callout: none; -webkit-user-select: none; user-select: none;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* é®ç½©å±¤è¨­å®š */
        #status-bar-mask {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--status-bar-height);
            background-color: var(--mask-color); z-index: 100; pointer-events: none;
        }
        #gap-mask {
            position: fixed; bottom: var(--dock-height); left: 0; width: 100%; height: var(--gap-height);
            background-color: var(--mask-color); z-index: 55; pointer-events: none;
        }

        /* Dock å±¤ */
        #fixed-dock-container {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--dock-height);
            z-index: 50; overflow: hidden; pointer-events: none;
        }
        #fixed-dock-image {
            width: 100%; height: 100vh; position: absolute; bottom: 0; left: 0;
            background-image: url('page1.png'); background-size: cover;
            background-position: center bottom; background-repeat: no-repeat;
        }

        /* æ»‘å‹•å®¹å™¨ */
        #slider {
            display: flex; width: 100vw; height: 100vh; overflow-x: auto; overflow-y: hidden;
            scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scrollbar-width: none;
            position: relative; z-index: 1; 
        }
        #slider::-webkit-scrollbar { display: none; }
        .slide {
            position: relative; flex: 0 0 100vw; height: 100vh; scroll-snap-align: start;
            background-size: cover; background-position: center top; background-repeat: no-repeat; overflow: hidden;
        }
        #page-1 { background-image: url('page1.png'); }
        #page-2 { background-image: url('page2.png'); }
        #page-3 { background-image: url('page3.png'); }

        /* === æš—è¼¸å…¥ç³»çµ± UI === */
        
        /* 1. æ•¸å­—è¼¸å…¥ç¶²æ ¼ (è¦†è“‹åœ¨ Page 1 ä¸Šæ–¹ App å€åŸŸ) */
        #number-grid {
            position: absolute;
            top: var(--status-bar-height); /* å¾ç‹€æ…‹åˆ—ä¸‹æ–¹é–‹å§‹ */
            left: 5%; /* å·¦å³ç•™é‚Šè·ï¼Œé¿å…èª¤è§¸é‚Šç·£ */
            width: 90%;
            height: 60%; /* è¦†è“‹å¤§ç´„å‰ 4-5 æ’ App */
            z-index: 80;
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4æ¬„ */
            grid-template-rows: repeat(5, 1fr);    /* 5åˆ— (é ç•™ç©ºé–“) */
            gap: 5px;
        }

        .num-btn {
            /* background: rgba(0,0,255,0.2); æµ‹è¯•ç”¨ */
            border-radius: 15px;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }
        .num-btn:active { background-color: rgba(0,0,0,0.3); } /* é»æ“Šå›é¥‹ */

        /* 2. èŠ±è‰²è¼¸å…¥ç¶²æ ¼ (è¦†è“‹åœ¨ Dock å€åŸŸ) */
        #suit-grid {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--dock-height);
            z-index: 90; /* æœ€é«˜å±¤ç´šï¼Œç¢ºä¿èƒ½é»æ“Š */
            display: flex;
        }

        .suit-btn {
            flex: 1; /* å¹³åˆ† 4 å€‹å€åŸŸ */
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }
        .suit-btn:active { background-color: rgba(0,0,0,0.3); }

        /* === åˆ†é åœ“é» === */
        #pagination {
            position: fixed; bottom: calc(var(--dock-height) + (var(--gap-height) / 2) - 4px);
            left: 0; width: 100%; display: flex; justify-content: center; gap: 8px;
            pointer-events: none; z-index: 70; transition: opacity 0.2s;
        }
        .dot {
            width: 8px; height: 8px; background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%; transition: background-color 0.2s; backdrop-filter: blur(2px);
        }
        .dot.active { background-color: #fff; }

        /* === é–‹ç™¼è€…æ¨¡å¼ === */
        .dev-mode #number-grid .num-btn {
            border: 1px solid cyan;
            color: cyan;
            display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 20px;
            background: rgba(0, 255, 255, 0.1);
        }
        .dev-mode #suit-grid .suit-btn {
            border: 1px solid magenta;
            color: magenta;
            display: flex; justify-content: center; align-items: center; font-weight: bold; font-size: 30px;
            background: rgba(255, 0, 255, 0.1);
        }
        
        .dev-mode #gap-mask { background-color: rgba(255, 255, 0, 0.3) !important; border: 1px dashed yellow; }
        .dev-mode #status-bar-mask { background-color: rgba(0, 255, 0, 0.3) !important; }
        .dev-mode #fixed-dock-container { border-top: 2px solid red; }

        #dev-info { display: none; position: fixed; top: 100px; left: 0; width: 100%; background: rgba(0,0,0,0.8); color: #0f0; padding: 10px; text-align: center; font-family: monospace; font-size: 14px; z-index: 200; pointer-events: none; }
        #secret-switch { position: fixed; bottom: 0; right: 0; width: 60px; height: 60px; z-index: 99; }
    </style>
</head>
<body>

    <div id="status-bar-mask"></div>
    <div id="gap-mask"></div>
    <div id="fixed-dock-container">
        <div id="fixed-dock-image"></div>
    </div>

    <!-- èŠ±è‰²è¼¸å…¥å±¤ (Dock) - å›ºå®šåœ¨åº•éƒ¨ -->
    <div id="suit-grid">
        <div class="suit-btn" onclick="selectSuit('S')"></div> <!-- é»‘æ¡ƒ -->
        <div class="suit-btn" onclick="selectSuit('H')"></div> <!-- ç´…å¿ƒ -->
        <div class="suit-btn" onclick="selectSuit('C')"></div> <!-- æ¢…èŠ± -->
        <div class="suit-btn" onclick="selectSuit('D')"></div> <!-- æ–¹å¡Š -->
    </div>

    <div id="slider">
        <div id="page-1" class="slide">
            <!-- æ•¸å­—è¼¸å…¥å±¤ (è¦†è“‹åœ¨ App ä¸Š) -->
            <div id="number-grid">
                <!-- Row 1 -->
                <div class="num-btn" onclick="selectNum(1)"></div>
                <div class="num-btn" onclick="selectNum(2)"></div>
                <div class="num-btn" onclick="selectNum(3)"></div>
                <div class="num-btn" onclick="selectNum(4)"></div>
                <!-- Row 2 -->
                <div class="num-btn" onclick="selectNum(5)"></div>
                <div class="num-btn" onclick="selectNum(6)"></div>
                <div class="num-btn" onclick="selectNum(7)"></div>
                <div class="num-btn" onclick="selectNum(8)"></div>
                <!-- Row 3 -->
                <div class="num-btn" onclick="selectNum(9)"></div>
                <div class="num-btn" onclick="selectNum(10)"></div>
                <div class="num-btn" onclick="selectNum(11)"></div>
                <div class="num-btn" onclick="selectNum(12)"></div>
                <!-- Row 4 -->
                <div class="num-btn" onclick="selectNum(13)"></div>
                <div class="num-btn"></div> <!-- ç©ºä½ -->
                <div class="num-btn"></div> <!-- ç©ºä½ -->
                <div class="num-btn"></div> <!-- ç©ºä½ -->
            </div>
            
            <img src="page1.png" style="display:none;" onerror="alert('âš ï¸ è®€å–ä¸åˆ° page1.png')">
        </div>
        <div id="page-2" class="slide"></div>
        <div id="page-3" class="slide"></div>
    </div>

    <div id="pagination">
        <div class="dot active"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    </div>

    <div id="secret-switch" onclick="toggleDevMode()"></div>
    <div id="dev-info"></div>

    <script>
        // --- å…¨åŸŸè®Šæ•¸ ---
        let currentNumber = null; // æš«å­˜é¸åˆ°çš„æ•¸å­—
        
        // --- UI é€£å‹• ---
        const slider = document.getElementById('slider');
        const dockContainer = document.getElementById('fixed-dock-container');
        const gapMask = document.getElementById('gap-mask');
        // åŒæ™‚ç§»å‹• Suit Grid
        const suitGrid = document.getElementById('suit-grid');
        
        const dots = document.querySelectorAll('.dot');
        const dotsContainer = document.getElementById('pagination');
        let viewportWidth = window.innerWidth;

        // --- æ»‘å‹•é‚è¼¯ ---
        slider.addEventListener('scroll', () => {
            const x = slider.scrollLeft;
            const pageIndex = Math.round(x / viewportWidth);
            
            dots.forEach((dot, index) => dot.classList.toggle('active', index === pageIndex));

            const page2Start = viewportWidth; 
            if (x > page2Start) {
                const offset = x - page2Start;
                dockContainer.style.transform = `translateX(${-offset}px)`;
                gapMask.style.transform = `translateX(${-offset}px)`;
                suitGrid.style.transform = `translateX(${-offset}px)`; // æŒ‰éˆ•ä¹Ÿè¦è·Ÿè‘—æ»‘èµ°
                dotsContainer.style.opacity = offset > viewportWidth * 0.5 ? '0' : '1';
            } else {
                dockContainer.style.transform = `translateX(0px)`;
                gapMask.style.transform = `translateX(0px)`;
                suitGrid.style.transform = `translateX(0px)`;
                dotsContainer.style.opacity = '1';
            }
        });

        window.addEventListener('resize', () => { viewportWidth = window.innerWidth; });

        // --- æ ¸å¿ƒè¼¸å…¥é‚è¼¯ ---

        // æ­¥é©Ÿ 1: é¸æ“‡æ•¸å­—
        function selectNum(num) {
            currentNumber = num;
            console.log("æš«å­˜æ•¸å­—: " + num);
            // å›é¥‹ï¼šçŸ­éœ‡å‹• 1 ä¸‹
            if (navigator.vibrate) navigator.vibrate(20);
            
            if(isDevMode) showToast(`å·²é¸æ“‡æ•¸å­—: ${num} (è«‹é¸èŠ±è‰²)`);
        }

        // æ­¥é©Ÿ 2: é¸æ“‡èŠ±è‰²ä¸¦è¤‡è£½
        function selectSuit(suit) {
            // å¦‚æœé‚„æ²’é¸æ•¸å­—ï¼Œé è¨­ç‚º 1 (æˆ–æ˜¯ä½ å¯ä»¥é¸æ“‡ä¸åšä»»ä½•äº‹)
            if (currentNumber === null) {
                // currentNumber = 1; // é¸é …: é è¨­ç‚º Ace
                if(isDevMode) { showToast("âš ï¸ è«‹å…ˆé»æ“Šä¸Šæ–¹ App é¸æ“‡æ•¸å­—ï¼"); return; }
            }

            // çµ„åˆä»£ç¢¼ (ä¾‹å¦‚: "S-12", "H-1")
            const finalCode = `${suit}-${currentNumber || 1}`;
            
            // åŸ·è¡Œè¤‡è£½
            copyToClipboard(finalCode);
            
            console.log("è¤‡è£½æˆåŠŸ: " + finalCode);
            
            // å›é¥‹ï¼šçŸ­éœ‡å‹• 2 ä¸‹ (è¡¨ç¤ºå®Œæˆ)
            if (navigator.vibrate) navigator.vibrate([30, 50, 30]);

            if(isDevMode) showToast(`ğŸ“‹ å·²è¤‡è£½: ${finalCode}`);
            
            // é‡ç½®æ•¸å­—ï¼Œé¿å…èª¤è§¸
            currentNumber = null;
        }

        function copyToClipboard(text) {
            const el = document.createElement('textarea');
            el.value = text;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            try { document.execCommand('copy'); } catch (e) {}
            document.body.removeChild(el);
        }

        // --- é–‹ç™¼è€…æ¨¡å¼ ---
        let isDevMode = false;
        function toggleDevMode() {
            isDevMode = !isDevMode;
            document.body.classList.toggle('dev-mode');
            
            // åœ¨é–‹ç™¼æ¨¡å¼ä¸‹é¡¯ç¤ºæ–‡å­—æ¨™ç±¤
            const numBtns = document.querySelectorAll('.num-btn');
            numBtns.forEach((btn, idx) => {
                if (idx < 13) btn.innerText = idx + 1;
            });
            const suitBtns = document.querySelectorAll('.suit-btn');
            const suits = ['â™ ï¸', 'â™¥ï¸', 'â™£ï¸', 'â™¦ï¸'];
            suitBtns.forEach((btn, idx) => btn.innerText = suits[idx]);

            const info = document.getElementById('dev-info');
            if (isDevMode) {
                info.style.display = 'block';
                alert("ğŸ”´ é–‹ç™¼æ¨¡å¼\n\nä¸Šæ–¹è—æ¡†ï¼šæ•¸å­— 1-13\nä¸‹æ–¹ç²‰ç´…æ¡†ï¼šèŠ±è‰² (é»æ“Šè§¸ç™¼è¤‡è£½)\n\né †åºï¼šå…ˆé»æ•¸å­— -> å†é»èŠ±è‰²");
            } else {
                info.style.display = 'none';
                numBtns.forEach(b => b.innerText = '');
                suitBtns.forEach(b => b.innerText = '');
            }
        }
        
        // ç°¡å–®çš„æç¤ºè¦–çª— (åƒ…é–‹ç™¼æ¨¡å¼ç”¨)
        function showToast(msg) {
            const info = document.getElementById('dev-info');
            info.innerText = msg;
            info.style.display = 'block';
            setTimeout(() => { if(isDevMode) info.innerText = "é–‹ç™¼æ¨¡å¼å¾…æ©Ÿä¸­..."; }, 2000);
        }

        document.body.addEventListener('touchmove', function(e) {}, { passive: false });
    </script>
</body>
</html>